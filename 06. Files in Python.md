# Files in Python

Files are data or information stored on a computer. Python uses **file objects** to interact with files and **perform I/O** operations. Files can be of various types, such as text, image, audio, etc. To work with files in Python, we do not need to use or import any additional modules (except for some operations like renaming or deleting files, where `os` is used).

---

## 1. Opening a File

**Description:**
Before starting to read from or write to files, the first step is to actually open the file. For this purpose, the `open()` function is used, which creates a file pointer. This pointer is stored in a variable. The interaction mode with the file must be specified.

**File Modes:**

* `r`: **Read** – Opens file for reading. **File must exist**.
* `w`: **Write** – Opens file for writing. **Overwrites if file exists**.
* `a`: **Append** – Opens file for writing at the end. **Preserves existing content**.
* `x`: **Create** – Creates new file. **Fails if file exists**.
* `rb`: **Read binary** – Opens non-text file for reading.
* `wb`: **Write binary** – Opens non-text file for writing.

**Example:**

```python
filename = "app.log"
with open(filename, "r") as f:
    print(f)
# Output: <_io.TextIOWrapper name='app.log' mode='r' encoding='cp1252'>
```

Directly calling `open()` without `with`:

```python
f = open("app.py", "r")
print(f)
f.close()
# Output: <_io.TextIOWrapper name='app.py' mode='r' encoding='cp1252'>
```

**Using `with` automatically closes the file.**

---

## 2. Creating a Text File

**Description:**
You can create and write to a text file using `w` or `x` modes. The `with` statement ensures proper handling of the file.

**Example:**

```python
filename = "new_file.txt"
with open(filename, "w") as f:
    f.write("This is a new file.\n")
    f.write("Python makes file handling easy.\n")
    f.write("An example.\n")
    f.write("Z to A\n")
```

Using `x` mode raises an error if the file already exists.

---

## 3. Reading a File using with and as

**Description:**
There are three main methods for reading files: `read()`, `readline()`, and `readlines()`.

**Methods:**

* `read()`: Returns the entire file or up to N bytes.
* `readline()`: Returns a single line or up to N bytes.
* `readlines()`: Returns the entire file line by line as a list.

**Example:**

```python
with open("app.log", "r") as f:
    print(f.read())        # Output: entire file content
    print(f.readline())    # Output: first line of the file
    lines = f.readlines()
    for line in lines:
        print(line)        # Output: each line one by one
```

---

## 4. Reading a File without with and as

**Description:**
Files can be read manually, but you must close them afterwards.

**Example:**

```python
myFile = open("C:/myTextFile.txt")
print(myFile.read(15))     # Reads first 15 characters

words = myFile.read().split()
print("File has:", len(words), "words")

words.sort()
print("Sorted list:\n", words)

myFile.close()
```

**Output**

```
This is a new f
File has: 11 words
Sorted list:
 ['A', 'An', 'Python', 'Z', 'easy.', 'example.', 'file', 'handling', 'ile.', 'makes', 'to']
```

**Example with sorting lines:**

```python
myFile = open("C:/myTextFile.txt")
lines = myFile.readlines()
lines.sort()
print(lines)
myFile.close()
```

**Output**

```
['An example.\n', 'Python makes file handling easy.\n', 'This is a new file.\n', 'Z to A\n']
```

---

## 5. Reading a File using for

**Description:**
A file can be iterated line by line using a for loop.

**Example 1:**

```python
i = 1
for line in open("C:/myTextFile.txt"):
    print("*" * i)
    i += 1
```

**Output**

```
*
**
***
****
```

**Example: 1**

```python
i = 1
with open("C:/myTextFile.txt", "r") as f:
    for lines in f.readlines():
        print("*"*i)
        i+=1
```

**Output**

```
*
**
***
****
```

**Example removing special characters : \n of text**

```python
L = []
with open('MyFile.txt', 'r') as F:
    for s in F:
        L.append(s.rstrip('\n'))
print(L)
```

**Output:**

```
['This is a new file.', 'Python makes file handling easy.', 'An example.', 'Z to A']
```
---

## 6. Writing to a File

**Description:**
You can write to a file using `write()` for single strings and `writelines()` for lists. Modes `w` and `a` control whether the file is overwritten or appended.

**Non-append writing (without with and as):**

```python
myFile = open("C:/myTextFile.txt", 'w')
myFile.write("A text from a python developer!!")
myFile.close()
```

**Append writing (without with and as):**

```python
myFile = open("C:/myTextFile.txt", 'a')
myFile.write("A text from a python developer!!")
myFile.close()
```

**Open the file and see its output**

```python
myFile = open(filename, 'r')
print(myFile.read())
myFile.close()
```

**Output**
```

This is a new file.
Python makes file handling easy.
An example.
Z to A
Another text from a python developer!!
```

**Append another text**

```python
with open(filename, "a") as myFile:
    myFile.write("Writing another text with with as open file\n")
```

**Read the file again:**

```python
with open(filename, "r") as myFile:
    print(myFile.read())
```

**Output**

```
This is a new file.
Python makes file handling easy.
An example.
Z to A
Another text from a python developer!!
Writing another text with with as open file
```

**Writing with `with` and `as`  - `w`: overwrite if file exist):**

```python
one_line = "Hello World"
multiple_lines = ["Hello World\n", "Nice to Meet You\n"]

with open(r"C:\Users\Majid\myFiles\app.log", "w") as f:
    f.write(one_line + "\n")
    f.writelines(multiple_lines)
```

**Open the file and see its content**

```python
with open(r"C:\Users\Majid\myFiles\app.log", "r") as f:
    print(f.read())
```

**Output**

```
Hello World
Hello World
Nice to Meet You
```


## 7. Opening a Binary File (Reading and Writing)

**Description:**
Binary files like images, videos, and archives can be read and written using `rb` and `wb`.

**Example:**

```python
myFile1 = open(r"C:\Users\Majid\myFiles\test.rar", 'rb')
myFile2 = open(r"C:\Users\Majid\myFiles\test2.rar", 'wb')

while True:
    buf = myFile1.read(512)
    if len(buf) == 0:
        break
    myFile2.write(buf)

myFile1.close()
myFile2.close()
```

---

## 8. Renaming and Deleting a File – Working with Directory

**Description:**
Use the `os` module to rename, delete, and manage directories.

**Example:**

```python
import os

os.rename('D:/1.txt', 'D:/2.txt')
os.remove('D:/2.txt')
os.mkdir('D:/mydir')
os.chdir('D:/')
os.rmdir('D:/mydir')
```

---

## 9. Checking if a File Exists

**Description:**
Before opening a file, you can check if it exists using the `os.path.exists()` function to prevent errors.

**Example:**

```python
import os

if os.path.exists("app.log"):
    print("File exists")
else:
    print("File does not exist")
```

---

## 10. Exception Handling with Files

**Description:**
Always handle exceptions while working with files to avoid runtime errors.

**Example:**

```python
try:
    with open("nonexistent.txt", "r") as f:
        print(f.read())
except FileNotFoundError:
    print("File not found!")
```

---

## 11. Working with CSV Files

**Description:**
Python can read and write CSV files using the `csv` module.

**Example:**

```python
import csv

# Writing CSV
with open('data.csv', 'w', newline='') as csvfile:
    writer = csv.writer(csvfile)
    writer.writerow(['Name', 'Age'])
    writer.writerow(['Alice', 30])
    writer.writerow(['Bob', 25])

# Reading CSV
with open('data.csv', 'r') as csvfile:
    reader = csv.reader(csvfile)
    for row in reader:
        print(row)
# Output: ['Name', 'Age'], ['Alice', '30'], ['Bob', '25']
```

---

## 12. Reading and Writing Excel Files

**Description:**
Python can handle Excel files using `pandas`. You can read `.xlsx` or `.xls` files and write dataframes to Excel.

**Example:**

```python
import pandas as pd

# Writing Excel file
data = {'Name': ['Alice', 'Bob'], 'Age': [30, 25]}
df = pd.DataFrame(data)
df.to_excel('data.xlsx', index=False)

# Reading Excel file
df_read = pd.read_excel('data.xlsx')
print(df_read)
# Output:
#     Name  Age
# 0  Alice   30
# 1    Bob   25
```

---

## 13. Reading PDF Files

**Description:**
Python can extract text from PDF files using `PyPDF2`.

**Example:**

```python
import PyPDF2

with open('sample.pdf', 'rb') as file:
    reader = PyPDF2.PdfReader(file)
    text = ""
    for page in reader.pages:
        text += page.extract_text()
print(text)
```

*Output:* Text content of the PDF file.

---

## 14. Writing PDF Files

**Description:**
You can create PDF files using the `FPDF` library. This allows writing text and generating a PDF from Python.

**Example:**

```python
from fpdf import FPDF

pdf = FPDF()
pdf.add_page()
pdf.set_font("Arial", size=12)
pdf.cell(200, 10, txt="Hello World!", ln=True, align="C")
pdf.cell(200, 10, txt="Python can write PDFs.", ln=True, align="C")

pdf.output("output.pdf")
```

*Output:* Creates a file named `output.pdf` containing the written text.

---

## 15. Summary Table of File Methods

| Method/Function        | Description                             | Example                              |
| ---------------------- | --------------------------------------- | ------------------------------------ |
| `open(filename, mode)` | Open a file for reading/writing         | `open("app.log", "r")`               |
| `close()`              | Close the file                          | `f.close()`                          |
| `read(size)`           | Read full file or N bytes               | `f.read(10)`                         |
| `readline(size)`       | Read one line or N bytes                | `f.readline()`                       |
| `readlines()`          | Read entire file as a list of lines     | `lines = f.readlines()`              |
| `write(string)`        | Write a single string to file           | `f.write("Hello")`                   |
| `writelines(list)`     | Write a list of strings to file         | `f.writelines(["line1", "line2"])`   |
| `with open() as f`     | Open file safely with automatic closing | `with open("app.log","r") as f: ...` |
| `os.rename(src,dest)`  | Rename a file                           | `os.rename('1.txt','2.txt')`         |
| `os.remove(filename)`  | Delete a file                           | `os.remove('2.txt')`                 |
| `os.mkdir(path)`       | Create a new directory                  | `os.mkdir('mydir')`                  |
| `os.chdir(path)`       | Change current directory                | `os.chdir('D:/')`                    |
| `os.rmdir(path)`       | Remove a directory                      | `os.rmdir('mydir')`                  |
| `os.path.exists(path)` | Check if file exists                    | `os.path.exists("app.log")`          |

---

The tutorial now includes **reading/writing Excel files, reading PDFs, and writing PDFs** while keeping all previous topics intact.
